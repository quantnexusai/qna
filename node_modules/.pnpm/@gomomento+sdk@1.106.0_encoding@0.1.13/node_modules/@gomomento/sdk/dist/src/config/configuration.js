"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CacheConfiguration = void 0;
class CacheConfiguration {
    constructor(props) {
        this.loggerFactory = props.loggerFactory;
        this.retryStrategy = props.retryStrategy;
        this.transportStrategy = props.transportStrategy;
        this.middlewares = props.middlewares;
        this.throwOnErrors = props.throwOnErrors;
        this.readConcern = props.readConcern;
        this.compression = props.compression;
    }
    getLoggerFactory() {
        return this.loggerFactory;
    }
    getRetryStrategy() {
        return this.retryStrategy;
    }
    withRetryStrategy(retryStrategy) {
        return new CacheConfiguration({
            ...this,
            retryStrategy,
        });
    }
    getTransportStrategy() {
        return this.transportStrategy;
    }
    withTransportStrategy(transportStrategy) {
        return new CacheConfiguration({
            ...this,
            transportStrategy,
        });
    }
    withNumConnections(numConnections) {
        return this.withTransportStrategy(this.getTransportStrategy().withGrpcConfig(this.getTransportStrategy()
            .getGrpcConfig()
            .withNumClients(numConnections)));
    }
    withMaxMessageLength(maxMessageLength) {
        return this.withTransportStrategy(this.getTransportStrategy().withGrpcConfig(this.getTransportStrategy()
            .getGrpcConfig()
            .withMaxReceiveMessageLength(maxMessageLength)
            .withMaxSendMessageLength(maxMessageLength)));
    }
    getMiddlewares() {
        return this.middlewares;
    }
    withMiddlewares(middlewares) {
        return new CacheConfiguration({
            ...this,
            middlewares,
        });
    }
    addMiddleware(middleware) {
        return new CacheConfiguration({
            ...this,
            middlewares: [middleware, ...this.middlewares],
        });
    }
    withClientTimeoutMillis(clientTimeout) {
        return new CacheConfiguration({
            ...this,
            transportStrategy: this.transportStrategy.withClientTimeoutMillis(clientTimeout),
        });
    }
    getThrowOnErrors() {
        return this.throwOnErrors;
    }
    withThrowOnErrors(throwOnErrors) {
        return new CacheConfiguration({
            ...this,
            throwOnErrors,
        });
    }
    getReadConcern() {
        return this.readConcern;
    }
    withReadConcern(readConcern) {
        return new CacheConfiguration({
            ...this,
            readConcern,
        });
    }
    getCompressionStrategy() {
        return this.compression;
    }
    withCompressionStrategy(compressionStrategy) {
        return new CacheConfiguration({
            ...this,
            compression: compressionStrategy,
        });
    }
    hasCompressionStrategy() {
        return this.compression !== undefined;
    }
}
exports.CacheConfiguration = CacheConfiguration;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb25maWcvY29uZmlndXJhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFzS0EsTUFBYSxrQkFBa0I7SUFTN0IsWUFBWSxLQUF5QjtRQUNuQyxJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUM7UUFDekMsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDO1FBQ3pDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUM7UUFDakQsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQztRQUN6QyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUM7UUFDckMsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDO0lBQ3ZDLENBQUM7SUFFRCxnQkFBZ0I7UUFDZCxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUM7SUFDNUIsQ0FBQztJQUVELGdCQUFnQjtRQUNkLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQztJQUM1QixDQUFDO0lBRUQsaUJBQWlCLENBQUMsYUFBNEI7UUFDNUMsT0FBTyxJQUFJLGtCQUFrQixDQUFDO1lBQzVCLEdBQUcsSUFBSTtZQUNQLGFBQWE7U0FDZCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsb0JBQW9CO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ2hDLENBQUM7SUFFRCxxQkFBcUIsQ0FBQyxpQkFBb0M7UUFDeEQsT0FBTyxJQUFJLGtCQUFrQixDQUFDO1lBQzVCLEdBQUcsSUFBSTtZQUNQLGlCQUFpQjtTQUNsQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsa0JBQWtCLENBQUMsY0FBc0I7UUFDdkMsT0FBTyxJQUFJLENBQUMscUJBQXFCLENBQy9CLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLGNBQWMsQ0FDeEMsSUFBSSxDQUFDLG9CQUFvQixFQUFFO2FBQ3hCLGFBQWEsRUFBRTthQUNmLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FDbEMsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVELG9CQUFvQixDQUFDLGdCQUF3QjtRQUMzQyxPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FDL0IsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUMsY0FBYyxDQUN4QyxJQUFJLENBQUMsb0JBQW9CLEVBQUU7YUFDeEIsYUFBYSxFQUFFO2FBQ2YsMkJBQTJCLENBQUMsZ0JBQWdCLENBQUM7YUFDN0Msd0JBQXdCLENBQUMsZ0JBQWdCLENBQUMsQ0FDOUMsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVELGNBQWM7UUFDWixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDMUIsQ0FBQztJQUVELGVBQWUsQ0FBQyxXQUF5QjtRQUN2QyxPQUFPLElBQUksa0JBQWtCLENBQUM7WUFDNUIsR0FBRyxJQUFJO1lBQ1AsV0FBVztTQUNaLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxhQUFhLENBQUMsVUFBc0I7UUFDbEMsT0FBTyxJQUFJLGtCQUFrQixDQUFDO1lBQzVCLEdBQUcsSUFBSTtZQUNQLFdBQVcsRUFBRSxDQUFDLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7U0FDL0MsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELHVCQUF1QixDQUFDLGFBQXFCO1FBQzNDLE9BQU8sSUFBSSxrQkFBa0IsQ0FBQztZQUM1QixHQUFHLElBQUk7WUFDUCxpQkFBaUIsRUFDZixJQUFJLENBQUMsaUJBQWlCLENBQUMsdUJBQXVCLENBQUMsYUFBYSxDQUFDO1NBQ2hFLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxnQkFBZ0I7UUFDZCxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUM7SUFDNUIsQ0FBQztJQUVELGlCQUFpQixDQUFDLGFBQXNCO1FBQ3RDLE9BQU8sSUFBSSxrQkFBa0IsQ0FBQztZQUM1QixHQUFHLElBQUk7WUFDUCxhQUFhO1NBQ2QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELGNBQWM7UUFDWixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDMUIsQ0FBQztJQUVELGVBQWUsQ0FBQyxXQUF3QjtRQUN0QyxPQUFPLElBQUksa0JBQWtCLENBQUM7WUFDNUIsR0FBRyxJQUFJO1lBQ1AsV0FBVztTQUNaLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxzQkFBc0I7UUFDcEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzFCLENBQUM7SUFFRCx1QkFBdUIsQ0FDckIsbUJBQXdDO1FBRXhDLE9BQU8sSUFBSSxrQkFBa0IsQ0FBQztZQUM1QixHQUFHLElBQUk7WUFDUCxXQUFXLEVBQUUsbUJBQW1CO1NBQ2pDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxzQkFBc0I7UUFDcEIsT0FBTyxJQUFJLENBQUMsV0FBVyxLQUFLLFNBQVMsQ0FBQztJQUN4QyxDQUFDO0NBQ0Y7QUFsSUQsZ0RBa0lDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtSZXRyeVN0cmF0ZWd5fSBmcm9tICcuL3JldHJ5L3JldHJ5LXN0cmF0ZWd5JztcbmltcG9ydCB7TWlkZGxld2FyZX0gZnJvbSAnLi9taWRkbGV3YXJlL21pZGRsZXdhcmUnO1xuaW1wb3J0IHtNb21lbnRvTG9nZ2VyRmFjdG9yeSwgVHJhbnNwb3J0U3RyYXRlZ3l9IGZyb20gJy4uLyc7XG5pbXBvcnQge1JlYWRDb25jZXJufSBmcm9tICdAZ29tb21lbnRvL3Nkay1jb3JlJztcbmltcG9ydCB7Q29tcHJlc3Npb25TdHJhdGVneX0gZnJvbSAnLi9jb21wcmVzc2lvbi9jb21wcmVzc2lvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlndXJhdGlvblByb3BzIHtcbiAgLyoqXG4gICAqIENvbmZpZ3VyZXMgbG9nZ2luZyB2ZXJib3NpdHkgYW5kIGZvcm1hdFxuICAgKi9cbiAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3Rvcnk7XG4gIC8qKlxuICAgKiBDb25maWd1cmVzIGhvdyBhbmQgd2hlbiBmYWlsZWQgcmVxdWVzdHMgd2lsbCBiZSByZXRyaWVkXG4gICAqL1xuICByZXRyeVN0cmF0ZWd5OiBSZXRyeVN0cmF0ZWd5O1xuICAvKipcbiAgICogQ29uZmlndXJlcyBsb3ctbGV2ZWwgb3B0aW9ucyBmb3IgbmV0d29yayBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgTW9tZW50byBzZXJ2aWNlXG4gICAqL1xuICB0cmFuc3BvcnRTdHJhdGVneTogVHJhbnNwb3J0U3RyYXRlZ3k7XG4gIC8qKlxuICAgKiBDb25maWd1cmVzIG1pZGRsZXdhcmUgZnVuY3Rpb25zIHRoYXQgd2lsbCB3cmFwIGVhY2ggcmVxdWVzdFxuICAgKi9cbiAgbWlkZGxld2FyZXM6IE1pZGRsZXdhcmVbXTtcbiAgLyoqXG4gICAqIENvbmZpZ3VyZXMgd2hldGhlciB0aGUgY2xpZW50IHNob3VsZCByZXR1cm4gYSBNb21lbnRvIEVycm9yIG9iamVjdCBvciB0aHJvdyBhbiBleGNlcHRpb24gd2hlbiBhbiBlcnJvciBvY2N1cnMuXG4gICAqL1xuICB0aHJvd09uRXJyb3JzOiBib29sZWFuO1xuICAvKipcbiAgICogQ29uZmlndXJlcyB0aGUgcmVhZCBjb25jZXJuIGZvciB0aGUgY2xpZW50LlxuICAgKi9cbiAgcmVhZENvbmNlcm46IFJlYWRDb25jZXJuO1xuICAvKipcbiAgICogQ29uZmlndXJlcyBjb21wcmVzc2lvbiBjYXBhYmlsaXRpZXMgZm9yIHRoZSBjbGllbnQuXG4gICAqL1xuICBjb21wcmVzc2lvbjogQ29tcHJlc3Npb25TdHJhdGVneSB8IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIE1vbWVudG8gQ2FjaGVDbGllbnQuXG4gKlxuICogQGV4cG9ydFxuICogQGludGVyZmFjZSBDb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlndXJhdGlvbiB7XG4gIC8qKlxuICAgKiBAcmV0dXJucyB7TW9tZW50b0xvZ2dlckZhY3Rvcnl9IHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbG9nZ2luZyB2ZXJib3NpdHkgYW5kIGZvcm1hdFxuICAgKi9cbiAgZ2V0TG9nZ2VyRmFjdG9yeSgpOiBNb21lbnRvTG9nZ2VyRmFjdG9yeTtcblxuICAvKipcbiAgICogQHJldHVybnMge1JldHJ5U3RyYXRlZ3l9IHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgaG93IGFuZCB3aGVuIGZhaWxlZCByZXF1ZXN0cyB3aWxsIGJlIHJldHJpZWRcbiAgICovXG4gIGdldFJldHJ5U3RyYXRlZ3koKTogUmV0cnlTdHJhdGVneTtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciBmb3Igb3ZlcnJpZGluZyBSZXRyeVN0cmF0ZWd5XG4gICAqIEBwYXJhbSB7UmV0cnlTdHJhdGVneX0gcmV0cnlTdHJhdGVneVxuICAgKiBAcmV0dXJucyB7Q29uZmlndXJhdGlvbn0gYSBuZXcgQ29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIFJldHJ5U3RyYXRlZ3lcbiAgICovXG4gIHdpdGhSZXRyeVN0cmF0ZWd5KHJldHJ5U3RyYXRlZ3k6IFJldHJ5U3RyYXRlZ3kpOiBDb25maWd1cmF0aW9uO1xuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7VHJhbnNwb3J0U3RyYXRlZ3l9IHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3Igd2lyZSBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgTW9tZW50byBzZXJ2aWNlXG4gICAqL1xuICBnZXRUcmFuc3BvcnRTdHJhdGVneSgpOiBUcmFuc3BvcnRTdHJhdGVneTtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciBmb3Igb3ZlcnJpZGluZyBUcmFuc3BvcnRTdHJhdGVneVxuICAgKiBAcGFyYW0ge1RyYW5zcG9ydFN0cmF0ZWd5fSB0cmFuc3BvcnRTdHJhdGVneVxuICAgKiBAcmV0dXJucyB7Q29uZmlndXJhdGlvbn0gYSBuZXcgQ29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIFRyYW5zcG9ydFN0cmF0ZWd5XG4gICAqL1xuICB3aXRoVHJhbnNwb3J0U3RyYXRlZ3kodHJhbnNwb3J0U3RyYXRlZ3k6IFRyYW5zcG9ydFN0cmF0ZWd5KTogQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogU2hvcnRoYW5kIGNvcHkgY29uc3RydWN0b3IgZm9yIG92ZXJyaWRpbmcgVHJhbnNwb3J0U3RyYXRlZ3kuR3JwY1N0cmF0ZWd5Lk51bUNsaWVudHMuIFRoaXMgd2lsbFxuICAgKiBhbGxvdyB5b3UgdG8gY29udHJvbCB0aGUgbnVtYmVyIG9mIFRDUCBjb25uZWN0aW9ucyB0aGF0IHRoZSBjbGllbnQgd2lsbCBvcGVuIHRvIHRoZSBzZXJ2ZXIuIFVzdWFsbHlcbiAgICogeW91IHNob3VsZCBzdGljayB3aXRoIHRoZSBkZWZhdWx0IHZhbHVlIGZyb20geW91ciBwcmUtYnVpbHQgY29uZmlndXJhdGlvbiwgYnV0IGl0IGNhbiBiZSB2YWx1YWJsZVxuICAgKiB0byBpbmNyZWFzZSB0aGlzIHZhbHVlIGluIG9yZGVyIHRvIGVuc3VyZSBtb3JlIGV2ZW5seSBkaXN0cmlidXRlZCBsb2FkIG9uIE1vbWVudG8gc2VydmVycy5cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IG51bUNvbm5lY3Rpb25zXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSB1cGRhdGVkIFRyYW5zcG9ydFN0cmF0ZWd5XG4gICAqL1xuICB3aXRoTnVtQ29ubmVjdGlvbnMobnVtQ29ubmVjdGlvbnM6IG51bWJlcik6IENvbmZpZ3VyYXRpb247XG5cbiAgLyoqXG4gICAqIFNob3J0aGFuZCBjb3B5IGNvbnN0cnVjdG9yIGZvciBvdmVycmlkaW5nIFRyYW5zcG9ydFN0cmF0ZWd5LkdycGNDb25maWcgbWVzc2FnZSBsZW5ndGhzLiBUaGlzIHdpbGxcbiAgICogYWxsb3cgeW91IHRvIGFkanVzdCB0aGUgbWF4aW11bSBtZXNzYWdlIGxlbmd0aCB0aGUgY2xpZW50IGNhbiBzZW5kIGFuZCByZWNlaXZlIGZyb20gdGhlIHNlcnZlci5cbiAgICpcbiAgICogVGhpcyBpcyBvbmx5IHJlbGV2YW50IGlmIHlvdSBoYXZlIHJlcXVlc3RlZCBhIHNlcnZpY2UgbGltaXQgaW5jcmVhc2UgYmV5b25kIHRoZSBkZWZhdWx0IHZhbHVlLlxuICAgKiBAcGFyYW0ge251bWJlcn0gbWF4TWVzc2FnZUxlbmd0aCAtIHRoZSBtYXggbWVzc2FnZSBsZW5ndGggKGluIGJ5dGVzKSB0aGUgY2xpZW50IGNhbiBzZW5kIGFuZCByZWNlaXZlXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSB1cGRhdGVkIFRyYW5zcG9ydFN0cmF0ZWd5XG4gICAqL1xuICB3aXRoTWF4TWVzc2FnZUxlbmd0aChtYXhNZXNzYWdlTGVuZ3RoOiBudW1iZXIpOiBDb25maWd1cmF0aW9uO1xuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7TWlkZGxld2FyZVtdfSB0aGUgbWlkZGxld2FyZSBmdW5jdGlvbnMgdGhhdCB3aWxsIHdyYXAgZWFjaCByZXF1ZXN0XG4gICAqL1xuICBnZXRNaWRkbGV3YXJlcygpOiBNaWRkbGV3YXJlW107XG5cbiAgLyoqXG4gICAqIENvcHkgY29uc3RydWN0b3IgZm9yIG92ZXJyaWRpbmcgTWlkZGxld2FyZXNcbiAgICogQHBhcmFtIHtNaWRkbGV3YXJlW119IG1pZGRsZXdhcmVzXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgTWlkZGxld2FyZXNcbiAgICovXG4gIHdpdGhNaWRkbGV3YXJlcyhtaWRkbGV3YXJlczogTWlkZGxld2FyZVtdKTogQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciB0aGF0IGFkZHMgYSBzaW5nbGUgbWlkZGxld2FyZSB0byB0aGUgZXhpc3RpbmcgbWlkZGxld2FyZXNcbiAgICogQHBhcmFtIHtNaWRkbGV3YXJlfSBtaWRkbGV3YXJlXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgTWlkZGxld2FyZSBhcHBlbmRlZCB0byB0aGUgbGlzdCBvZiBleGlzdGluZyBNaWRkbGV3YXJlc1xuICAgKi9cbiAgYWRkTWlkZGxld2FyZShtaWRkbGV3YXJlOiBNaWRkbGV3YXJlKTogQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogQ29udmVuaWVuY2UgY29weSBjb25zdHJ1Y3RvciB0aGF0IHVwZGF0ZXMgdGhlIGNsaWVudC1zaWRlIHRpbWVvdXQgc2V0dGluZyBpbiB0aGUgVHJhbnNwb3J0U3RyYXRlZ3lcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNsaWVudFRpbWVvdXRNaWxsaXNcbiAgICogQHJldHVybnMge0NvbmZpZ3VyYXRpb259IGEgbmV3IENvbmZpZ3VyYXRpb24gb2JqZWN0IHdpdGggaXRzIFRyYW5zcG9ydFN0cmF0ZWd5IHVwZGF0ZWQgdG8gdXNlIHRoZSBzcGVjaWZpZWQgY2xpZW50IHRpbWVvdXRcbiAgICovXG4gIHdpdGhDbGllbnRUaW1lb3V0TWlsbGlzKGNsaWVudFRpbWVvdXRNaWxsaXM6IG51bWJlcik6IENvbmZpZ3VyYXRpb247XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBDb25maWd1cmVzIHdoZXRoZXIgdGhlIGNsaWVudCBzaG91bGQgcmV0dXJuIGEgTW9tZW50byBFcnJvciBvYmplY3Qgb3IgdGhyb3cgYW4gZXhjZXB0aW9uIHdoZW4gYW5cbiAgICogZXJyb3Igb2NjdXJzLiBCeSBkZWZhdWx0LCB0aGlzIGlzIHNldCB0byBmYWxzZSwgYW5kIHRoZSBjbGllbnQgd2lsbCByZXR1cm4gYSBNb21lbnRvIEVycm9yIG9iamVjdCBvbiBlcnJvcnMuIFNldCBpdFxuICAgKiB0byB0cnVlIGlmIHlvdSBwcmVmZXIgZm9yIGV4Y2VwdGlvbnMgdG8gYmUgdGhyb3duLlxuICAgKi9cbiAgZ2V0VGhyb3dPbkVycm9ycygpOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBDb3B5IGNvbnN0cnVjdG9yIGZvciBjb25maWd1cmluZyB3aGV0aGVyIHRoZSBjbGllbnQgc2hvdWxkIHJldHVybiBhIE1vbWVudG8gRXJyb3Igb2JqZWN0IG9yIHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIGFuXG4gICAqIGVycm9yIG9jY3Vycy4gQnkgZGVmYXVsdCwgdGhpcyBpcyBzZXQgdG8gZmFsc2UsIGFuZCB0aGUgY2xpZW50IHdpbGwgcmV0dXJuIGEgTW9tZW50byBFcnJvciBvYmplY3Qgb24gZXJyb3JzLiBTZXQgaXRcbiAgICogdG8gdHJ1ZSBpZiB5b3UgcHJlZmVyIGZvciBleGNlcHRpb25zIHRvIGJlIHRocm93bi5cbiAgICogQHBhcmFtIHtib29sZWFufSB0aHJvd09uRXJyb3JzXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgdGhyb3dPbkVycm9ycyBzZXR0aW5nXG4gICAqL1xuICB3aXRoVGhyb3dPbkVycm9ycyh0aHJvd09uRXJyb3JzOiBib29sZWFuKTogQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogQHJldHVybnMge1JlYWRDb25jZXJufSB0aGUgY3VycmVudCBjb25maWd1cmF0aW9uIG9wdGlvbiBmb3IgcmVhZCBjb25zaXN0ZW5jeVxuICAgKi9cbiAgZ2V0UmVhZENvbmNlcm4oKTogUmVhZENvbmNlcm47XG5cbiAgLyoqXG4gICAqIENvcHkgY29uc3RydWN0b3IgZm9yIG92ZXJyaWRpbmcgUmVhZENvbmNlcm5cbiAgICogQHBhcmFtIHtSZWFkQ29uY2Vybn0gcmVhZENvbmNlcm5cbiAgICogQHJldHVybnMge0NvbmZpZ3VyYXRpb259IGEgbmV3IENvbmZpZ3VyYXRpb24gb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBSZWFkQ29uY2VyblxuICAgKi9cbiAgd2l0aFJlYWRDb25jZXJuKHJlYWRDb25jZXJuOiBSZWFkQ29uY2Vybik6IENvbmZpZ3VyYXRpb247XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtJQ29tcHJlc3Npb259IHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb24gc2V0dGluZ3MgZm9yIGNvbXByZXNzaW9uXG4gICAqL1xuICBnZXRDb21wcmVzc2lvblN0cmF0ZWd5KCk6IENvbXByZXNzaW9uU3RyYXRlZ3kgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIENvcHkgY29uc3RydWN0b3IgZm9yIG92ZXJyaWRpbmcgY29tcHJlc3Npb24gc2V0dGluZ3NcbiAgICogQHBhcmFtIHtJQ29tcHJlc3Npb259IGNvbXByZXNzaW9uXG4gICAqIEByZXR1cm5zIHtDb25maWd1cmF0aW9ufSBhIG5ldyBDb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgY29tcHJlc3Npb24gc2V0dGluZ3NcbiAgICovXG4gIHdpdGhDb21wcmVzc2lvblN0cmF0ZWd5KGNvbXByZXNzaW9uOiBDb21wcmVzc2lvblN0cmF0ZWd5KTogQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogQHJldHVybnMge2Jvb2xlYW59IHdoZXRoZXIgdGhlIGNsaWVudCBoYXMgYSBjb21wcmVzc2lvbiBzdHJhdGVneSBjb25maWd1cmVkLlxuICAgKi9cbiAgaGFzQ29tcHJlc3Npb25TdHJhdGVneSgpOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgQ2FjaGVDb25maWd1cmF0aW9uIGltcGxlbWVudHMgQ29uZmlndXJhdGlvbiB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3Rvcnk7XG4gIHByaXZhdGUgcmVhZG9ubHkgcmV0cnlTdHJhdGVneTogUmV0cnlTdHJhdGVneTtcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFuc3BvcnRTdHJhdGVneTogVHJhbnNwb3J0U3RyYXRlZ3k7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWlkZGxld2FyZXM6IE1pZGRsZXdhcmVbXTtcbiAgcHJpdmF0ZSByZWFkb25seSB0aHJvd09uRXJyb3JzOiBib29sZWFuO1xuICBwcml2YXRlIHJlYWRvbmx5IHJlYWRDb25jZXJuOiBSZWFkQ29uY2VybjtcbiAgcHJpdmF0ZSByZWFkb25seSBjb21wcmVzc2lvbjogQ29tcHJlc3Npb25TdHJhdGVneSB8IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogQ29uZmlndXJhdGlvblByb3BzKSB7XG4gICAgdGhpcy5sb2dnZXJGYWN0b3J5ID0gcHJvcHMubG9nZ2VyRmFjdG9yeTtcbiAgICB0aGlzLnJldHJ5U3RyYXRlZ3kgPSBwcm9wcy5yZXRyeVN0cmF0ZWd5O1xuICAgIHRoaXMudHJhbnNwb3J0U3RyYXRlZ3kgPSBwcm9wcy50cmFuc3BvcnRTdHJhdGVneTtcbiAgICB0aGlzLm1pZGRsZXdhcmVzID0gcHJvcHMubWlkZGxld2FyZXM7XG4gICAgdGhpcy50aHJvd09uRXJyb3JzID0gcHJvcHMudGhyb3dPbkVycm9ycztcbiAgICB0aGlzLnJlYWRDb25jZXJuID0gcHJvcHMucmVhZENvbmNlcm47XG4gICAgdGhpcy5jb21wcmVzc2lvbiA9IHByb3BzLmNvbXByZXNzaW9uO1xuICB9XG5cbiAgZ2V0TG9nZ2VyRmFjdG9yeSgpOiBNb21lbnRvTG9nZ2VyRmFjdG9yeSB7XG4gICAgcmV0dXJuIHRoaXMubG9nZ2VyRmFjdG9yeTtcbiAgfVxuXG4gIGdldFJldHJ5U3RyYXRlZ3koKTogUmV0cnlTdHJhdGVneSB7XG4gICAgcmV0dXJuIHRoaXMucmV0cnlTdHJhdGVneTtcbiAgfVxuXG4gIHdpdGhSZXRyeVN0cmF0ZWd5KHJldHJ5U3RyYXRlZ3k6IFJldHJ5U3RyYXRlZ3kpOiBDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gbmV3IENhY2hlQ29uZmlndXJhdGlvbih7XG4gICAgICAuLi50aGlzLFxuICAgICAgcmV0cnlTdHJhdGVneSxcbiAgICB9KTtcbiAgfVxuXG4gIGdldFRyYW5zcG9ydFN0cmF0ZWd5KCk6IFRyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgICByZXR1cm4gdGhpcy50cmFuc3BvcnRTdHJhdGVneTtcbiAgfVxuXG4gIHdpdGhUcmFuc3BvcnRTdHJhdGVneSh0cmFuc3BvcnRTdHJhdGVneTogVHJhbnNwb3J0U3RyYXRlZ3kpOiBDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gbmV3IENhY2hlQ29uZmlndXJhdGlvbih7XG4gICAgICAuLi50aGlzLFxuICAgICAgdHJhbnNwb3J0U3RyYXRlZ3ksXG4gICAgfSk7XG4gIH1cblxuICB3aXRoTnVtQ29ubmVjdGlvbnMobnVtQ29ubmVjdGlvbnM6IG51bWJlcik6IENvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiB0aGlzLndpdGhUcmFuc3BvcnRTdHJhdGVneShcbiAgICAgIHRoaXMuZ2V0VHJhbnNwb3J0U3RyYXRlZ3koKS53aXRoR3JwY0NvbmZpZyhcbiAgICAgICAgdGhpcy5nZXRUcmFuc3BvcnRTdHJhdGVneSgpXG4gICAgICAgICAgLmdldEdycGNDb25maWcoKVxuICAgICAgICAgIC53aXRoTnVtQ2xpZW50cyhudW1Db25uZWN0aW9ucylcbiAgICAgIClcbiAgICApO1xuICB9XG5cbiAgd2l0aE1heE1lc3NhZ2VMZW5ndGgobWF4TWVzc2FnZUxlbmd0aDogbnVtYmVyKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMud2l0aFRyYW5zcG9ydFN0cmF0ZWd5KFxuICAgICAgdGhpcy5nZXRUcmFuc3BvcnRTdHJhdGVneSgpLndpdGhHcnBjQ29uZmlnKFxuICAgICAgICB0aGlzLmdldFRyYW5zcG9ydFN0cmF0ZWd5KClcbiAgICAgICAgICAuZ2V0R3JwY0NvbmZpZygpXG4gICAgICAgICAgLndpdGhNYXhSZWNlaXZlTWVzc2FnZUxlbmd0aChtYXhNZXNzYWdlTGVuZ3RoKVxuICAgICAgICAgIC53aXRoTWF4U2VuZE1lc3NhZ2VMZW5ndGgobWF4TWVzc2FnZUxlbmd0aClcbiAgICAgIClcbiAgICApO1xuICB9XG5cbiAgZ2V0TWlkZGxld2FyZXMoKTogTWlkZGxld2FyZVtdIHtcbiAgICByZXR1cm4gdGhpcy5taWRkbGV3YXJlcztcbiAgfVxuXG4gIHdpdGhNaWRkbGV3YXJlcyhtaWRkbGV3YXJlczogTWlkZGxld2FyZVtdKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBDYWNoZUNvbmZpZ3VyYXRpb24oe1xuICAgICAgLi4udGhpcyxcbiAgICAgIG1pZGRsZXdhcmVzLFxuICAgIH0pO1xuICB9XG5cbiAgYWRkTWlkZGxld2FyZShtaWRkbGV3YXJlOiBNaWRkbGV3YXJlKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBDYWNoZUNvbmZpZ3VyYXRpb24oe1xuICAgICAgLi4udGhpcyxcbiAgICAgIG1pZGRsZXdhcmVzOiBbbWlkZGxld2FyZSwgLi4udGhpcy5taWRkbGV3YXJlc10sXG4gICAgfSk7XG4gIH1cblxuICB3aXRoQ2xpZW50VGltZW91dE1pbGxpcyhjbGllbnRUaW1lb3V0OiBudW1iZXIpOiBDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gbmV3IENhY2hlQ29uZmlndXJhdGlvbih7XG4gICAgICAuLi50aGlzLFxuICAgICAgdHJhbnNwb3J0U3RyYXRlZ3k6XG4gICAgICAgIHRoaXMudHJhbnNwb3J0U3RyYXRlZ3kud2l0aENsaWVudFRpbWVvdXRNaWxsaXMoY2xpZW50VGltZW91dCksXG4gICAgfSk7XG4gIH1cblxuICBnZXRUaHJvd09uRXJyb3JzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRocm93T25FcnJvcnM7XG4gIH1cblxuICB3aXRoVGhyb3dPbkVycm9ycyh0aHJvd09uRXJyb3JzOiBib29sZWFuKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBDYWNoZUNvbmZpZ3VyYXRpb24oe1xuICAgICAgLi4udGhpcyxcbiAgICAgIHRocm93T25FcnJvcnMsXG4gICAgfSk7XG4gIH1cblxuICBnZXRSZWFkQ29uY2VybigpOiBSZWFkQ29uY2VybiB7XG4gICAgcmV0dXJuIHRoaXMucmVhZENvbmNlcm47XG4gIH1cblxuICB3aXRoUmVhZENvbmNlcm4ocmVhZENvbmNlcm46IFJlYWRDb25jZXJuKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBDYWNoZUNvbmZpZ3VyYXRpb24oe1xuICAgICAgLi4udGhpcyxcbiAgICAgIHJlYWRDb25jZXJuLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0Q29tcHJlc3Npb25TdHJhdGVneSgpOiBDb21wcmVzc2lvblN0cmF0ZWd5IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jb21wcmVzc2lvbjtcbiAgfVxuXG4gIHdpdGhDb21wcmVzc2lvblN0cmF0ZWd5KFxuICAgIGNvbXByZXNzaW9uU3RyYXRlZ3k6IENvbXByZXNzaW9uU3RyYXRlZ3lcbiAgKTogQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBDYWNoZUNvbmZpZ3VyYXRpb24oe1xuICAgICAgLi4udGhpcyxcbiAgICAgIGNvbXByZXNzaW9uOiBjb21wcmVzc2lvblN0cmF0ZWd5LFxuICAgIH0pO1xuICB9XG5cbiAgaGFzQ29tcHJlc3Npb25TdHJhdGVneSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jb21wcmVzc2lvbiAhPT0gdW5kZWZpbmVkO1xuICB9XG59XG4iXX0=