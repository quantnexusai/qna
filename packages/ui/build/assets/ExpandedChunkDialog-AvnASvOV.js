import{P as r,R as K,x as F,r as l,z as X,H as M,j as e,D as Q,q as U,T as Y,w as O,I as Z,t as $,A as P}from"./index-ChaGAcYI.js";import{R as _}from"./main-ByC2YqwJ.js";import{C as w}from"./CodeEditor-DWi0nNjN.js";import{I as y,a as ee}from"./IconSearch-BD2fMQi-.js";import{I as te}from"./IconTrash-BdsDnRZh.js";import{I as ae}from"./IconLanguage-Ck-NidEz.js";const se=({show:c,dialogProps:s,onCancel:C,onChunkEdit:R,onDeleteChunk:V,isReadOnly:p})=>{var D;const G=document.getElementById("portal"),d=K(a=>a.customization),m=F(),[t,b]=l.useState(),[x,j]=l.useState(),[n,f]=l.useState(!1),[h,u]=l.useState(""),[g,o]=l.useState({}),J=a=>{const i=a.src;Array.isArray(i)||typeof i=="object"?navigator.clipboard.writeText(JSON.stringify(i,null,"  ")):navigator.clipboard.writeText(i)},q=()=>{u(t==null?void 0:t.pageContent),o(t!=null&&t.metadata?JSON.parse(t==null?void 0:t.metadata):{}),f(!1)},H=()=>{R(h,g,t)};l.useEffect(()=>{var a,i,S,k,E,v,I,T,A,N,z,B,L;return s.data&&(b((a=s.data)==null?void 0:a.selectedChunk),u((S=(i=s.data)==null?void 0:i.selectedChunk)==null?void 0:S.pageContent),j(s==null?void 0:s.data.selectedChunkNumber),(E=(k=s.data)==null?void 0:k.selectedChunk)!=null&&E.metadata&&(typeof((I=(v=s.data)==null?void 0:v.selectedChunk)==null?void 0:I.metadata)=="string"?o(JSON.parse((A=(T=s.data)==null?void 0:T.selectedChunk)==null?void 0:A.metadata)):typeof((z=(N=s.data)==null?void 0:N.selectedChunk)==null?void 0:z.metadata)=="object"&&o((L=(B=s.data)==null?void 0:B.selectedChunk)==null?void 0:L.metadata))),()=>{b(),j(),u(""),o({}),f(!1)}},[s]),l.useEffect(()=>(m(c?{type:X}:{type:M}),()=>m({type:M})),[c,m]);const W=c?e.jsxs(Q,{fullWidth:!0,maxWidth:"md",open:c,onClose:C,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(U,{style:{fontSize:"1rem"},id:"alert-dialog-title",children:t&&x&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsxs(Y,{sx:{flex:1},variant:"h4",children:["#",x,". ",t.id]}),!n&&!p&&e.jsx(y,{onClick:()=>f(!0),size:"small",color:"primary",title:"Edit Chunk",sx:{ml:2},children:e.jsx(ee,{})}),n&&!p&&e.jsx(O,{onClick:()=>q(),color:"primary",title:"Cancel",sx:{ml:2},children:"Cancel"}),n&&!p&&e.jsx(O,{onClick:()=>H(),color:"primary",title:"Save",variant:"contained",sx:{ml:2,mr:1},children:"Save"}),!n&&!p&&e.jsx(y,{onClick:()=>V(t),size:"small",color:"error",title:"Delete Chunk",sx:{ml:1},children:e.jsx(te,{})}),e.jsx(y,{onClick:C,size:"small",color:"inherit",title:"Close",sx:{ml:1},children:e.jsx(Z,{})})]})}),e.jsx($,{children:t&&x&&e.jsxs("div",{children:[e.jsxs("div",{style:{paddingLeft:"10px",paddingRight:"10px",paddingTop:"5px",paddingBottom:"5px",fontSize:"15px",width:"max-content",borderRadius:"25px",boxShadow:d.isDarkMode?"0 2px 14px 0 rgb(255 255 255 / 20%)":"0 2px 14px 0 rgb(32 40 45 / 20%)",display:"flex",flexDirection:"row",alignItems:"center",marginTop:"5px",marginBottom:"10px"},children:[e.jsx(ae,{style:{marginRight:5},size:15}),(D=t==null?void 0:t.pageContent)==null?void 0:D.length," characters"]}),e.jsx("div",{style:{marginTop:"5px"}}),!n&&e.jsx(w,{disabled:!0,height:"max-content",value:h,theme:d.isDarkMode?"dark":"light",basicSetup:{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1}}),n&&e.jsx(w,{disabled:!1,autoFocus:!0,height:"max-content",value:h,theme:d.isDarkMode?"dark":"light",basicSetup:{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1},onValueChange:a=>u(a)}),e.jsxs("div",{style:{marginTop:"20px",marginBottom:"15px"},children:[!n&&e.jsx(_,{theme:d.isDarkMode?"ocean":"rjv-default",src:g,style:{padding:"10px"},name:null,quotesOnKeys:!1,enableClipboard:!1,displayDataTypes:!1,collapsed:1}),n&&e.jsx(_,{theme:d.isDarkMode?"ocean":"rjv-default",src:g,style:{padding:"10px"},name:null,quotesOnKeys:!1,displayDataTypes:!1,enableClipboard:a=>J(a),onEdit:a=>{o(a.updated_src)},onAdd:()=>{},onDelete:a=>{o(a.updated_src)}})]})]})})]}):null;return P.createPortal(W,G)};se.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onChunkEdit:r.func,onDeleteChunk:r.func,isReadOnly:r.bool};export{se as E};
