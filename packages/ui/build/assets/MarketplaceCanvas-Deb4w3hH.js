import{s as P,M as B,P as d,a as u,r as x,j as e,B as a,c as F,T as m,F as p,w as T,u as y,h as R,af as D,S as I,b0 as L,b3 as E,ae as M}from"./index-DnRqwzUl.js";import{L as O,b as f,c as W,A as $,u as z,d as G,R as H,C as J,B as U,S as q}from"./StickyNote-BWooxmXY.js";import{S as V}from"./StyledButton-UqN_3QZz.js";import{I as Z}from"./IconChevronLeft-pRyIaaZ-.js";import{I as K}from"./IconCopy-r160ectE.js";import"./Dropdown--aEEoNmI.js";import"./TextField-CWFlncnn.js";import"./OutlinedInput-BjbOs3SL.js";import"./IconSearch-DuKTugus.js";import"./FormControl-CwX-cgG8.js";import"./Menu-CKXvTZgV.js";import"./Popover-Bg7ct0u8.js";import"./TooltipWithParser-RGTD2K7r.js";import"./MultiDropdown-DK6HYnw_.js";import"./CredentialInputHandler-DbnyuUkE.js";import"./CredentialListDialog-DnIzHkJm.js";import"./ConfirmDialog-BByP0sN1.js";import"./Input-_ea17EIV.js";import"./main-CbJP_nn5.js";import"./CircularProgress-B03PZohM.js";import"./ManageScrapedLinksDialog-oyBXe673.js";import"./Delete-TrOmempa.js";import"./IconPlus-t_dssfTo.js";import"./DataGrid-CjSdxyq0.js";import"./CodeEditor-Dz_1ga14.js";import"./nodes-BRMCXOaS.js";import"./BackdropLoader-DvSyWYu7.js";import"./IconTrash-CLrlpA-z.js";import"./File-C_tX6sl7.js";import"./TabPanel--yhnObkH.js";import"./ToolDialog-CHaRIJhi.js";import"./ExportAsTemplateDialog-vEXodOiH.js";import"./IconTemplate-DPsYfI0A.js";import"./AssistantDialog-WQqxJYrf.js";import"./assistants-B5SDaL6U.js";import"./v4-D8aEg3BZ.js";import"./CodeBlock-BUx9IO7u.js";import"./ExpandMore-DAWxT99K.js";import"./Grid-88S9esAw.js";import"./IconBulb-Bbh13wkk.js";import"./IconRefresh-BWgNSOne.js";const Q=P(B)(({theme:t})=>({background:t.palette.card.main,color:t.darkTextPrimary,border:"solid 1px",borderColor:t.palette.primary[200]+75,width:"300px",height:"auto",padding:"10px",boxShadow:"0 2px 14px 0 rgb(32 40 45 / 8%)","&:hover":{borderColor:t.palette.primary.main}})),b=({data:t})=>{const s=u(),[l,r]=x.useState(!1),[c,h]=x.useState({}),g=()=>{const o={data:t,inputParams:t.inputParams.filter(i=>i.additionalParams),disabled:!0,confirmButtonName:"Save",cancelButtonName:"Cancel"};h(o),r(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{content:!1,sx:{padding:0,borderColor:t.selected?s.palette.primary.main:s.palette.text.secondary},border:!1,children:e.jsxs(a,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(a,{style:{width:50,marginRight:10,padding:5},children:e.jsx("div",{style:{...s.typography.commonAvatar,...s.typography.largeAvatar,borderRadius:"50%",backgroundColor:"white",cursor:"grab"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},src:`${F}/api/v1/node-icon/${t.name}`,alt:"Notification"})})}),e.jsx(a,{children:e.jsx(m,{sx:{fontSize:"1rem",fontWeight:500},children:t.label})}),e.jsx("div",{style:{flexGrow:1}}),t.tags&&t.tags.includes("LlamaIndex")&&e.jsx(e.Fragment,{children:e.jsx("div",{style:{borderRadius:"50%",padding:15},children:e.jsx("img",{style:{width:"25px",height:"25px",borderRadius:"50%",objectFit:"contain"},src:O,alt:"LlamaIndex"})})})]}),(t.inputAnchors.length>0||t.inputParams.length>0)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{}),e.jsx(a,{sx:{background:s.palette.asyncSelect.main,p:1},children:e.jsx(m,{sx:{fontWeight:500,textAlign:"center"},children:"Inputs"})}),e.jsx(p,{})]}),t.inputAnchors.map((o,i)=>e.jsx(f,{disabled:!0,inputAnchor:o,data:t},i)),t.inputParams.map((o,i)=>e.jsx(f,{disabled:!0,inputParam:o,data:t},i)),t.inputParams.find(o=>o.additionalParams)&&e.jsx("div",{style:{textAlign:"center",marginTop:t.inputParams.filter(o=>o.additionalParams).length===t.inputParams.length+t.inputAnchors.length?20:0},children:e.jsx(T,{sx:{borderRadius:25,width:"90%",mb:2},variant:"outlined",onClick:g,children:"Additional Parameters"})}),e.jsx(p,{}),e.jsx(a,{sx:{background:s.palette.asyncSelect.main,p:1},children:e.jsx(m,{sx:{fontWeight:500,textAlign:"center"},children:"Output"})}),e.jsx(p,{}),t.outputAnchors.map((o,i)=>e.jsx(W,{disabled:!0,outputAnchor:o,data:t},i))]})}),e.jsx($,{show:l,dialogProps:c,onCancel:()=>r(!1)})]})};b.propTypes={data:d.object};const v=({flowName:t,flowData:s,onChatflowCopy:l})=>{const r=u(),c=y();return e.jsxs(e.Fragment,{children:[e.jsx(a,{children:e.jsx(R,{title:"Back",sx:{borderRadius:"50%"},children:e.jsx(D,{variant:"rounded",sx:{...r.typography.commonAvatar,...r.typography.mediumAvatar,transition:"all .2s ease-in-out",background:r.palette.secondary.light,color:r.palette.secondary.dark,"&:hover":{background:r.palette.secondary.dark,color:r.palette.secondary.light}},color:"inherit",onClick:()=>c(-1),children:e.jsx(Z,{stroke:1.5,size:"1.3rem"})})})}),e.jsx(a,{sx:{flexGrow:1},children:e.jsx(I,{flexDirection:"row",children:e.jsx(m,{sx:{fontSize:"1.5rem",fontWeight:600,ml:2},children:t})})}),e.jsx(a,{children:e.jsx(V,{color:"secondary",variant:"contained",title:"Use Chatflow",onClick:()=>l(s),startIcon:e.jsx(K,{}),children:"Use Template"})})]})};v.propTypes={flowName:d.string,flowData:d.object,onChatflowCopy:d.func};const X={customNode:b,stickyNote:q},Y={buttonedge:""},$e=()=>{const t=u(),s=y(),{state:l}=L(),{flowData:r,name:c}=l,[h,g,o]=z(),[i,w,C]=G(),k=x.useRef(null);x.useEffect(()=>{if(r){const n=JSON.parse(r);g(n.nodes||[]),w(n.edges||[])}},[r]);const N=n=>{const S=((n==null?void 0:n.nodes)||[]).some(j=>j.data.category==="Multi Agents"||j.data.category==="Sequential Agents"),A=JSON.stringify(n);s(`/${S?"agentcanvas":"canvas"}`,{state:{templateFlowData:A}})};return e.jsx(e.Fragment,{children:e.jsxs(a,{children:[e.jsx(E,{enableColorOnDark:!0,position:"fixed",color:"inherit",elevation:1,sx:{bgcolor:t.palette.background.default},children:e.jsx(M,{children:e.jsx(v,{flowName:c,flowData:JSON.parse(r),onChatflowCopy:n=>N(n)})})}),e.jsx(a,{sx:{pt:"70px",height:"100vh",width:"100%"},children:e.jsx("div",{className:"reactflow-parent-wrapper",children:e.jsx("div",{className:"reactflow-wrapper",ref:k,children:e.jsxs(H,{nodes:h,edges:i,onNodesChange:o,onEdgesChange:C,nodesDraggable:!1,nodeTypes:X,edgeTypes:Y,fitView:!0,minZoom:.1,children:[e.jsx(J,{style:{display:"flex",flexDirection:"row",left:"50%",transform:"translate(-50%, -50%)"}}),e.jsx(U,{color:"#aaa",gap:16})]})})})})]})})};export{$e as default};
