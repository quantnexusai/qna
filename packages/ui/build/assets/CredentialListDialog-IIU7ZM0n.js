import{a3 as F,P as n,r,j as e,T as R,bi as Z,aE as D,bv as P,ah as ee,R as te,B as O,x as $,y as se,b as V,bK as ae,z as _,H as M,D as q,q as J,c as W,t as H,S as ne,v as oe,A as K,w as T,I as A,bL as ie,K as re,L as le,a as ce,am as de,an as pe}from"./index-YrBb95ol.js";import{a as he,H as fe,I as B}from"./TooltipWithParser-DKPjkixU.js";import{S as ge}from"./StyledButton-DXZyQiwo.js";import{C as xe}from"./ConfirmDialog-KE28Mtnw.js";import{D as ye}from"./Dropdown-B8fdFRp4.js";import{S as me,I as ue}from"./Input-B4-co-4L.js";import{F as U}from"./FormControl-wstEAgUr.js";import{R as L}from"./main-Dkicd77k.js";import{P as be}from"./Popover-BvGEjH7D.js";import{I as je,b as Ce}from"./IconSearch-D-OoqJyQ.js";import{O as G}from"./OutlinedInput-BhZIIZoj.js";/**
 * @license @tabler/icons-react v3.3.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var De=F("outline","alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.3.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ve=F("outline","arrows-maximize","IconArrowsMaximize",[["path",{d:"M16 4l4 0l0 4",key:"svg-0"}],["path",{d:"M14 10l6 -6",key:"svg-1"}],["path",{d:"M8 20l-4 0l0 -4",key:"svg-2"}],["path",{d:"M4 20l6 -6",key:"svg-3"}],["path",{d:"M16 20l4 0l0 -4",key:"svg-4"}],["path",{d:"M14 14l6 6",key:"svg-5"}],["path",{d:"M8 4l-4 0l0 4",key:"svg-6"}],["path",{d:"M4 4l6 6",key:"svg-7"}]]);const X=({label:t,value:s,onChange:o,disabled:m=!1})=>{const[h,x]=r.useState(s!==void 0?!!s:!1);return r.useEffect(()=>{x(s!==void 0?!!s:!1)},[s]),e.jsx(e.Fragment,{children:e.jsxs(U,{sx:{mt:1,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},size:"small",children:[t&&e.jsx(R,{children:t}),e.jsx(Z,{disabled:m,checked:h,onChange:i=>{x(i.target.checked),o(i.target.checked)}})]})})};X.propTypes={label:n.string,value:n.oneOfType([n.string,n.bool]),onChange:n.func,disabled:n.bool};const Se=()=>D.get("/credentials"),we=t=>D.get(`/credentials?credentialName=${t}`),ke=()=>D.get("/components-credentials"),Ae=t=>D.get(`/credentials/${t}`),Ie=t=>D.get(`/components-credentials/${t}`),Ee=t=>D.post("/credentials",t),Te=(t,s)=>D.put(`/credentials/${t}`,s),Ne=t=>D.delete(`/credentials/${t}`),N={getAllCredentials:Se,getCredentialsByName:we,getAllComponentsCredentials:ke,getSpecificCredential:Ae,getSpecificComponentCredential:Ie,createCredential:Ee,updateCredential:Te,deleteCredential:Ne},Q=({value:t,onChange:s,inputParam:o,nodes:m,edges:h,nodeId:x,disabled:i=!1,isDarkMode:b=!1,isSequentialAgent:j=!1})=>{const[c,g]=r.useState(t?JSON.parse(t):{}),[d,u]=r.useState([]),[p,v]=r.useState(""),[C,S]=r.useState(null),f=!!C,w=()=>{S(null)},z=l=>{const a=ee.cloneDeep(c);a[p]=l,s(JSON.stringify(a)),g(y=>({...y,[p]:l}))},I=l=>{const a=l.src;Array.isArray(a)||typeof a=="object"?navigator.clipboard.writeText(JSON.stringify(a,null,"  ")):navigator.clipboard.writeText(a)};return r.useEffect(()=>{if(!i&&m&&h&&x&&o){const l=o!=null&&o.acceptVariable?P(m,h,x,o.id):[];u(l)}},[i,o,m,h,x]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{sx:{mt:1,width:"100%"},size:"small",children:[i&&e.jsx(L,{theme:b?"ocean":"rjv-default",style:{padding:10,borderRadius:10},src:c,name:null,enableClipboard:l=>I(l),quotesOnKeys:!1,displayDataTypes:!1}),!i&&e.jsx("div",{children:e.jsx(L,{theme:b?"ocean":"rjv-default",style:{padding:10,borderRadius:10},src:c,name:null,quotesOnKeys:!1,displayDataTypes:!1,enableClipboard:l=>I(l),onMouseUp:l=>{o!=null&&o.acceptVariable&&(v(l.name),S(l.currentTarget))},onEdit:l=>{g(l.updated_src),s(JSON.stringify(l.updated_src))},onAdd:()=>{},onDelete:l=>{g(l.updated_src),s(JSON.stringify(l.updated_src))}})},JSON.stringify(c))]}),(o==null?void 0:o.acceptVariable)&&e.jsx(be,{open:f,anchorEl:C,onClose:w,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:e.jsx(me,{disabled:i,availableNodesForVariable:d,onSelectAndReturnVal:l=>{z(l),w()},isSequentialAgent:j})})]})};Q.propTypes={value:n.string,onChange:n.func,disabled:n.bool,isDarkMode:n.bool,inputParam:n.object,nodes:n.array,edges:n.array,nodeId:n.string,isSequentialAgent:n.bool};const Y=({inputParam:t,data:s,disabled:o=!1})=>{const m=te(d=>d.customization),h=r.useRef(null),[x,i]=r.useState(!1),[b,j]=r.useState({}),c=(d,u)=>{j({value:d,inputParam:u,disabled:o,confirmButtonName:"Save",cancelButtonName:"Cancel"}),i(!0)},g=(d,u)=>{i(!1),s[u]=d};return e.jsx("div",{ref:h,children:t&&e.jsx(e.Fragment,{children:e.jsxs(O,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(R,{children:[t.label,!t.optional&&e.jsx("span",{style:{color:"red"},children:" *"}),t.description&&e.jsx(he,{style:{marginLeft:10},title:t.description})]}),e.jsx("div",{style:{flexGrow:1}}),t.type==="string"&&t.rows&&e.jsx(je,{size:"small",sx:{height:25,width:25},title:"Expand",color:"primary",onClick:()=>c(s[t.name]??t.default??"",t),children:e.jsx(ve,{})})]}),t.warning&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",borderRadius:10,background:"rgb(254,252,191)",padding:10,marginTop:10,marginBottom:10},children:[e.jsx(De,{size:36,color:"orange"}),e.jsx("span",{style:{color:"rgb(116,66,16)",marginLeft:10},children:t.warning})]}),t.type==="boolean"&&e.jsx(X,{disabled:o,onChange:d=>s[t.name]=d,value:s[t.name]??t.default??!1}),(t.type==="string"||t.type==="password"||t.type==="number")&&e.jsx(ue,{disabled:o,inputParam:t,onChange:d=>s[t.name]=d,value:s[t.name]??t.default??"",showDialog:x,dialogProps:b,onDialogCancel:()=>i(!1),onDialogConfirm:(d,u)=>g(d,u)},s[t.name]),t.type==="json"&&e.jsx(Q,{disabled:o,onChange:d=>s[t.name]=d,value:s[t.name]??t.default??"",isDarkMode:m.isDarkMode}),t.type==="options"&&e.jsx(ye,{disabled:o,name:t.name,options:t.options,onSelect:d=>s[t.name]=d,value:s[t.name]??t.default??"choose an option"})]})})})};Y.propTypes={inputAnchor:n.object,inputParam:n.object,data:n.object,disabled:n.bool};const Oe=({show:t,dialogProps:s,onCancel:o,onConfirm:m,setError:h})=>{const x=document.getElementById("portal"),i=$();se();const b=(...a)=>i(re(...a)),j=(...a)=>i(le(...a)),c=V(N.getSpecificCredential),g=V(N.getSpecificComponentCredential),[d,u]=r.useState({}),[p,v]=r.useState(""),[C,S]=r.useState({}),[f,w]=r.useState({});r.useEffect(()=>{c.data&&(u(c.data),c.data.name&&v(c.data.name),c.data.plainDataObj&&S(c.data.plainDataObj),g.request(c.data.credentialName))},[c.data]),r.useEffect(()=>{g.data&&w(g.data)},[g.data]),r.useEffect(()=>{c.error&&h&&h(c.error)},[c.error]),r.useEffect(()=>{g.error&&h&&h(g.error)},[g.error]),r.useEffect(()=>{if(s.type==="EDIT"&&s.data)c.request(s.data.id);else if(s.type==="EDIT"&&s.credentialId)c.request(s.credentialId);else if(s.type==="ADD"&&s.credentialComponent){v(""),u({});const a=ae(s.credentialComponent.inputs);S(a),w(s.credentialComponent)}},[s]),r.useEffect(()=>(i(t?{type:_}:{type:M}),()=>i({type:M})),[t,i]);const z=async()=>{try{const a={name:p,credentialName:f.name,plainDataObj:C},y=await N.createCredential(a);y.data&&(b({message:"New Credential added",options:{key:new Date().getTime()+Math.random(),variant:"success",action:E=>e.jsx(T,{style:{color:"white"},onClick:()=>j(E),children:e.jsx(A,{})})}}),m(y.data.id))}catch(a){h&&h(a),b({message:`Failed to add new Credential: ${typeof a.response.data=="object"?a.response.data.message:a.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:y=>e.jsx(T,{style:{color:"white"},onClick:()=>j(y),children:e.jsx(A,{})})}}),o()}},I=async()=>{try{const a={name:p,credentialName:f.name};let y={};for(const k in C)C[k]!==ie&&(y[k]=C[k]);Object.keys(y).length&&(a.plainDataObj=y);const E=await N.updateCredential(d.id,a);E.data&&(b({message:"Credential saved",options:{key:new Date().getTime()+Math.random(),variant:"success",action:k=>e.jsx(T,{style:{color:"white"},onClick:()=>j(k),children:e.jsx(A,{})})}}),m(E.data.id))}catch(a){h&&h(a),b({message:`Failed to save Credential: ${typeof a.response.data=="object"?a.response.data.message:a.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:y=>e.jsx(T,{style:{color:"white"},onClick:()=>j(y),children:e.jsx(A,{})})}}),o()}},l=t?e.jsxs(q,{fullWidth:!0,maxWidth:"sm",open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(J,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:f&&f.label&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx("div",{style:{width:50,height:50,marginRight:10,borderRadius:"50%",backgroundColor:"white"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:7,borderRadius:"50%",objectFit:"contain"},alt:f.name,src:`${W}/api/v1/components-credentials-icon/${f.name}`})}),f.label]})}),e.jsxs(H,{children:[f&&f.description&&e.jsx(O,{sx:{pl:2,pr:2},children:e.jsx("div",{style:{display:"flex",flexDirection:"row",borderRadius:10,background:"rgb(254,252,191)",padding:10,marginTop:10,marginBottom:10},children:e.jsx("span",{style:{color:"rgb(116,66,16)"},children:fe(f.description)})})}),f&&f.label&&e.jsxs(O,{sx:{p:2},children:[e.jsx(ne,{sx:{position:"relative"},direction:"row",children:e.jsxs(R,{variant:"overline",children:["Credential Name",e.jsx("span",{style:{color:"red"},children:" *"})]})}),e.jsx(G,{id:"credName",type:"string",fullWidth:!0,placeholder:f.label,value:p,name:"name",onChange:a=>v(a.target.value)})]}),f&&f.inputs&&f.inputs.map((a,y)=>e.jsx(Y,{inputParam:a,data:C},y))]}),e.jsx(oe,{children:e.jsx(ge,{disabled:!p,variant:"contained",onClick:()=>s.type==="ADD"?z():I(),children:s.confirmButtonName})}),e.jsx(xe,{})]}):null;return K.createPortal(l,x)};Oe.propTypes={show:n.bool,dialogProps:n.object,onCancel:n.func,onConfirm:n.func,setError:n.func};const Me=({show:t,dialogProps:s,onCancel:o,onCredentialSelected:m})=>{const h=document.getElementById("portal"),x=$(),i=ce(),[b,j]=r.useState(""),[c,g]=r.useState([]),d=p=>{j(p),setTimeout(()=>{if(p){const v=s.componentsCredentials.filter(C=>C.name.toLowerCase().includes(p.toLowerCase()));g(v)}else p===""&&g(s.componentsCredentials)},500)};r.useEffect(()=>{s.componentsCredentials&&g(s.componentsCredentials)},[s]),r.useEffect(()=>(x(t?{type:_}:{type:M}),()=>x({type:M})),[t,x]);const u=t?e.jsxs(q,{fullWidth:!0,maxWidth:"md",open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(J,{sx:{fontSize:"1rem",p:3,pb:0},id:"alert-dialog-title",children:s.title}),e.jsxs(H,{sx:{display:"flex",flexDirection:"column",gap:2,maxHeight:"75vh",position:"relative",px:3,pb:3},children:[e.jsx(O,{sx:{backgroundColor:i.palette.background.paper,pt:2,position:"sticky",top:0,zIndex:10},children:e.jsx(G,{sx:{width:"100%",pr:2,pl:2,position:"sticky"},id:"input-search-credential",value:b,onChange:p=>d(p.target.value),placeholder:"Search credential",startAdornment:e.jsx(B,{position:"start",children:e.jsx(Ce,{stroke:1.5,size:"1rem",color:i.palette.grey[500]})}),endAdornment:e.jsx(B,{position:"end",sx:{cursor:"pointer",color:i.palette.grey[500],"&:hover":{color:i.palette.grey[900]}},title:"Clear Search",children:e.jsx(A,{stroke:1.5,size:"1rem",onClick:()=>d(""),style:{cursor:"pointer"}})}),"aria-describedby":"search-helper-text",inputProps:{"aria-label":"weight"}})}),e.jsx(de,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:2,py:0,zIndex:9,borderRadius:"10px",[i.breakpoints.down("md")]:{maxWidth:370}},children:[...c].map(p=>e.jsxs(pe,{alignItems:"center",onClick:()=>m(p),sx:{border:1,borderColor:i.palette.grey[900]+25,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"start",textAlign:"left",gap:1,p:2},children:[e.jsx("div",{style:{width:50,height:50,borderRadius:"50%",backgroundColor:"white"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:7,borderRadius:"50%",objectFit:"contain"},alt:p.name,src:`${W}/api/v1/components-credentials-icon/${p.name}`})}),e.jsx(R,{children:p.label})]},p.name))})]})]}):null;return K.createPortal(u,h)};Me.propTypes={show:n.bool,dialogProps:n.object,onCancel:n.func,onCredentialSelected:n.func};export{Oe as A,Me as C,ve as I,Q as J,X as S,De as a,N as c};
