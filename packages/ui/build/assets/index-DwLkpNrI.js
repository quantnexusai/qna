import{s as B,N as ee,O as E,Q as I,a as te,R as se,x as ae,y as re,r as a,b as k,aj as oe,j as e,M as ie,S as N,B as p,U as ne,V as le,W as ce,X as de,Y as xe,c as he,$ as P,w as T,I as A,K as me,L as pe}from"./index-DnRqwzUl.js";import{S as je}from"./StyledButton-UqN_3QZz.js";import{C as Ce,A as ue,c as j}from"./CredentialListDialog-DnIzHkJm.js";import{u as fe,C as ge}from"./ConfirmDialog-BByP0sN1.js";import{V as Se}from"./ViewHeader-9nMyGl0H.js";import{E as ye}from"./ErrorBoundary-Cg9p9QiY.js";import{I as be,S as o}from"./IconPlus-t_dssfTo.js";import{I as M,a as De}from"./IconSearch-DuKTugus.js";import{I as we}from"./IconTrash-CLrlpA-z.js";import"./TooltipWithParser-RGTD2K7r.js";import"./Dropdown--aEEoNmI.js";import"./TextField-CWFlncnn.js";import"./OutlinedInput-BjbOs3SL.js";import"./FormControl-CwX-cgG8.js";import"./Menu-CKXvTZgV.js";import"./Popover-Bg7ct0u8.js";import"./Input-_ea17EIV.js";import"./main-CbJP_nn5.js";import"./StyledFab-ByxVeh_y.js";import"./IconArrowLeft-DlsmOOmz.js";import"./IconCopy-r160ectE.js";const ve="/assets/credential_empty-BUL4Jfyn.svg",s=B(ee)(({theme:i})=>({borderColor:i.palette.grey[900]+25,padding:"6px 16px",[`&.${E.head}`]:{color:i.palette.grey[900]},[`&.${E.body}`]:{fontSize:14,height:64}})),C=B(I)(()=>({"&:last-child td, &:last-child th":{border:0}})),We=()=>{const i=te(),u=se(t=>t.customization),c=ae();re();const f=(...t)=>c(me(...t)),g=(...t)=>c(pe(...t)),[S,L]=a.useState(!0),[y,b]=a.useState(null),[R,d]=a.useState(!1),[Y,$]=a.useState({}),[F,x]=a.useState(!1),[q,D]=a.useState({}),[w,V]=a.useState([]),[O,U]=a.useState([]),{confirm:z}=fe(),r=k(j.getAllCredentials),n=k(j.getAllComponentsCredentials),[_,G]=a.useState(""),H=t=>{G(t.target.value)};function W(t){return t.credentialName.toLowerCase().indexOf(_.toLowerCase())>-1}const X=()=>{$({title:"Add New Credential",componentsCredentials:O}),d(!0)},J=t=>{D({type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",credentialComponent:t}),x(!0)},K=t=>{D({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:t}),x(!0)},Q=async t=>{const l={title:"Delete",description:`Delete credential ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await z(l))try{(await j.deleteCredential(t.id)).data&&(f({message:"Credential deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:m=>e.jsx(T,{style:{color:"white"},onClick:()=>g(m),children:e.jsx(A,{})})}}),v())}catch(h){f({message:`Failed to delete Credential: ${typeof h.response.data=="object"?h.response.data.message:h.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:m=>e.jsx(T,{style:{color:"white"},onClick:()=>g(m),children:e.jsx(A,{})})}}),onCancel()}},Z=t=>{d(!1),J(t)},v=()=>{d(!1),x(!1),r.request()};return a.useEffect(()=>{r.request(),n.request()},[]),a.useEffect(()=>{L(r.loading)},[r.loading]),a.useEffect(()=>{r.data&&V(r.data)},[r.data]),a.useEffect(()=>{r.error&&b(r.error)},[r.error]),a.useEffect(()=>{n.data&&(U(n.data),c({type:oe,componentsCredentials:n.data}))},[n.data,c]),e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:y?e.jsx(ye,{error:y}):e.jsxs(N,{flexDirection:"column",sx:{gap:3},children:[e.jsx(Se,{onSearchChange:H,search:!0,searchPlaceholder:"Search Credentials",title:"Credentials",children:e.jsx(je,{variant:"contained",sx:{borderRadius:2,height:"100%"},onClick:X,startIcon:e.jsx(be,{}),children:"Add Credential"})}),!S&&w.length<=0?e.jsxs(N,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(p,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:ve,alt:"CredentialEmptySVG"})}),e.jsx("div",{children:"No Credentials Yet"})]}):e.jsx(ne,{sx:{border:1,borderColor:i.palette.grey[900]+25,borderRadius:2},component:le,children:e.jsxs(ce,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(de,{sx:{backgroundColor:u.isDarkMode?i.palette.common.black:i.palette.grey[100],height:56},children:e.jsxs(I,{children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Last Updated"}),e.jsx(s,{children:"Created"}),e.jsx(s,{children:" "}),e.jsx(s,{children:" "})]})}),e.jsx(xe,{children:S?e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})})]}),e.jsxs(C,{children:[e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})}),e.jsx(s,{children:e.jsx(o,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:w.filter(W).map((t,l)=>e.jsxs(C,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(s,{scope:"row",children:e.jsxs(p,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(p,{sx:{width:35,height:35,borderRadius:"50%",backgroundColor:u.isDarkMode?i.palette.common.white:i.palette.grey[300]+75},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},alt:t.credentialName,src:`${he}/api/v1/components-credentials-icon/${t.credentialName}`})}),t.name]})}),e.jsx(s,{children:P(t.updatedDate).format("MMMM Do, YYYY")}),e.jsx(s,{children:P(t.createdDate).format("MMMM Do, YYYY")}),e.jsx(s,{children:e.jsx(M,{title:"Edit",color:"primary",onClick:()=>K(t),children:e.jsx(De,{})})}),e.jsx(s,{children:e.jsx(M,{title:"Delete",color:"error",onClick:()=>Q(t),children:e.jsx(we,{})})})]},l))})})]})})]})}),e.jsx(Ce,{show:R,dialogProps:Y,onCancel:()=>d(!1),onCredentialSelected:Z}),e.jsx(ue,{show:F,dialogProps:q,onCancel:()=>x(!1),onConfirm:v,setError:b}),e.jsx(ge,{})]})};export{We as default};
