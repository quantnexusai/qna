import{P as E,x as be,a as ve,r,b as Y,z as et,H as xe,j as e,D as ye,q as ke,t as De,B as X,I as A,am as tt,an as at,c as Se,T as J,A as we,ah as st,ai as ot,a2 as rt,a0 as it,U as Re,V as Ee,W as Le,Y as Te,Q as O,N as Me,v as nt,w as v,o as F,p as P,s as K,O as me,E as lt,R as ct,u as dt,y as ht,ac as ut,M as pt,S as G,F as Ie,C as Q,X as xt,a5 as R,ao as mt,K as ft,L as gt}from"./index-YrBb95ol.js";import{D as jt,I as Ct,A as bt}from"./AddDocStoreDialog-DK6YkuVm.js";import{B as vt}from"./BackdropLoader-CslNJVg7.js";import{d as N}from"./documentstore-DL5qOG7D.js";import{O as yt}from"./OutlinedInput-BhZIIZoj.js";import{I as fe}from"./TooltipWithParser-DKPjkixU.js";import{b as kt,I as Dt}from"./IconSearch-D-OoqJyQ.js";import{E as St}from"./ErrorBoundary-CUY0ZYII.js";import{S as ge}from"./StyledButton-DXZyQiwo.js";import{V as wt}from"./ViewHeader-CCHuZACc.js";import{A as Rt,a as Et,d as Lt,b as Tt}from"./ExpandMore-DwWgoSjj.js";import{T as Mt}from"./Table-B1nl_7s4.js";import{n as It}from"./nodes-BVY53Wx2.js";import{v as _t}from"./v4-D8aEg3BZ.js";import{u as At,C as Vt}from"./ConfirmDialog-KE28Mtnw.js";import{d as _e,a as zt}from"./KeyboardArrowDown-CGAhc7fC.js";import{M as y,d as Ae}from"./Delete-BF9vyW48.js";import{M as $t}from"./Menu-B86QUi--.js";import{I as Nt}from"./IconRefresh-AU7jiZ3W.js";import{I as je,S as g}from"./IconPlus-BaXmZWfM.js";import"./CircularProgress-BFk_RX-E.js";import"./IconCopy-CsKaXIZ_.js";import"./StyledFab-DqqBf6Tt.js";import"./IconArrowLeft-ByFHgJ8H.js";import"./Popover-BvGEjH7D.js";const Ve=({show:a,dialogProps:i,onCancel:h,onDocLoaderSelected:b})=>{const L=document.getElementById("portal"),p=be(),d=ve(),[n,l]=r.useState(""),[T,k]=r.useState([]),D=Y(N.getDocumentLoaders),S=u=>{l(u)};function x(u){return u.name.toLowerCase().indexOf(n.toLowerCase())>-1}r.useEffect(()=>{i.documentLoaders&&k(i.documentLoaders)},[i]),r.useEffect(()=>{D.request()},[]),r.useEffect(()=>{D.data&&k(D.data)},[D.data]),r.useEffect(()=>(p(a?{type:et}:{type:xe}),()=>p({type:xe})),[a,p]);const V=a?e.jsxs(ye,{fullWidth:!0,maxWidth:"md",open:a,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ke,{sx:{fontSize:"1rem",p:3,pb:0},id:"alert-dialog-title",children:i.title}),e.jsxs(De,{sx:{display:"flex",flexDirection:"column",gap:2,maxHeight:"75vh",position:"relative",px:3,pb:3},children:[e.jsx(X,{sx:{backgroundColor:d.palette.background.paper,pt:2,position:"sticky",top:0,zIndex:10},children:e.jsx(yt,{sx:{width:"100%",pr:2,pl:2,position:"sticky"},id:"input-search-credential",value:n,onChange:u=>S(u.target.value),placeholder:"Search",startAdornment:e.jsx(fe,{position:"start",children:e.jsx(kt,{stroke:1.5,size:"1rem",color:d.palette.grey[500]})}),endAdornment:e.jsx(fe,{position:"end",sx:{cursor:"pointer",color:d.palette.grey[500],"&:hover":{color:d.palette.grey[900]}},title:"Clear Search",children:e.jsx(A,{stroke:1.5,size:"1rem",onClick:()=>S(""),style:{cursor:"pointer"}})}),"aria-describedby":"search-helper-text",inputProps:{"aria-label":"weight"}})}),e.jsx(tt,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:2,py:0,zIndex:9,borderRadius:"10px",[d.breakpoints.down("md")]:{maxWidth:370}},children:[...T].filter(x).map(u=>e.jsxs(at,{alignItems:"center",onClick:()=>b(u.name),sx:{border:1,borderColor:d.palette.grey[900]+25,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"start",textAlign:"left",gap:1,p:2},children:[e.jsx("div",{style:{width:50,height:50,borderRadius:"50%",backgroundColor:"white"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:7,borderRadius:"50%",objectFit:"contain"},alt:u.name,src:`${Se}/api/v1/node-icon/${u.name}`})}),e.jsx(J,{children:u.label})]},u.name))})]})]}):null;return we.createPortal(V,L)};Ve.propTypes={show:E.bool,dialogProps:E.object,onCancel:E.func,onDocLoaderSelected:E.func};const ze=({show:a,dialogProps:i,onCancel:h,onDelete:b})=>{const L=document.getElementById("portal"),[p,d]=r.useState({}),[n,l]=r.useState(!1),[T,k]=r.useState([]),[D,S]=r.useState([]),x=Y(It.getSpecificNode),V=t=>(j,M)=>{const I={...p};I[t]=M,d(I)};r.useEffect(()=>{if(i.recordManagerConfig){const t=i.recordManagerConfig.name;if(t&&x.request(t),i.vectorStoreConfig){const j=i.vectorStoreConfig.name;j&&x.request(j)}}return()=>{d({}),l(!1),k([]),S([])}},[i]),r.useEffect(()=>{if(x.data){const t=st.cloneDeep(ot(x.data,_t()));let j="vectorStoreConfig";t.category==="Record Manager"&&(j="recordManagerConfig");const M=[];for(const I in i[j].config){const f=t.inputParams.find(W=>W.name===I);if(!f||f.type==="credential")continue;let z={};const _=i[j].config[I];_&&(typeof _=="string"&&_.startsWith("{{")&&_.endsWith("}}")||(z={label:f==null?void 0:f.label,name:f==null?void 0:f.name,type:f==null?void 0:f.type,value:_},M.push(z)))}j==="vectorStoreConfig"?k([{label:t.label,name:t.name,category:t.category,id:t.id,paramValues:M}]):j==="recordManagerConfig"&&S([{label:t.label,name:t.name,category:t.category,id:t.id,paramValues:M}])}},[x.data]);const u=a?e.jsxs(ye,{fullWidth:!0,maxWidth:i.recordManagerConfig?"md":"sm",open:a,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ke,{sx:{fontSize:"1rem",p:3,pb:0},id:"alert-dialog-title",children:i.title}),e.jsxs(De,{sx:{display:"flex",flexDirection:"column",gap:2,maxHeight:"75vh",position:"relative",px:3,pb:3},children:[e.jsx("span",{style:{marginTop:"20px"},children:i.description}),i.type==="STORE"&&i.recordManagerConfig&&e.jsx(rt,{control:e.jsx(it,{checked:n,onChange:t=>l(t.target.checked)}),label:"Remove data from vector store"}),n&&e.jsxs("div",{children:[e.jsx(Re,{component:Ee,children:e.jsx(Le,{sx:{minWidth:650},"aria-label":"simple table",children:e.jsx(Te,{children:e.jsx(O,{sx:{"& td":{border:0}},children:e.jsx(Me,{sx:{pb:0,pt:0},colSpan:6,children:e.jsx(X,{children:[...T,...D].map((t,j)=>e.jsxs(Rt,{expanded:p[t.name]||!0,onChange:V(t.name),disableGutters:!0,children:[e.jsx(Et,{expandIcon:e.jsx(Lt,{}),"aria-controls":`nodes-accordian-${t.name}`,id:`nodes-accordian-header-${t.name}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx("div",{style:{width:40,height:40,marginRight:10,borderRadius:"50%",backgroundColor:"white"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:7,borderRadius:"50%",objectFit:"contain"},alt:t.name,src:`${Se}/api/v1/node-icon/${t.name}`})}),e.jsx(J,{variant:"h5",children:t.label})]})}),e.jsx(Tt,{children:t.paramValues[0]&&e.jsx(Mt,{sx:{minWidth:150},rows:t.paramValues,columns:Object.keys(t.paramValues[0])})})]},j))})})})})})}),e.jsx("span",{style:{marginTop:"30px",fontStyle:"italic",color:"#b35702"},children:"* Only data that were upserted with Record Manager will be deleted from vector store"})]})]}),e.jsxs(nt,{sx:{pr:3,pb:3},children:[e.jsx(v,{onClick:h,color:"primary",children:"Cancel"}),e.jsx(v,{variant:"contained",onClick:()=>b(i.type,i.file,n),color:"error",children:"Delete"})]})]}):null;return we.createPortal(u,L)};ze.propTypes={show:E.bool,dialogProps:E.object,onCancel:E.func,onDelete:E.func};var Z={},Bt=P;Object.defineProperty(Z,"__esModule",{value:!0});var ee=Z.default=void 0,Ot=Bt(F()),Ft=e,Pt=(0,Ot.default)((0,Ft.jsx)("path",{d:"M10 4h4v4h-4zM4 16h4v4H4zm0-6h4v4H4zm0-6h4v4H4zm10 8.42V10h-4v4h2.42zm6.88-1.13-1.17-1.17c-.16-.16-.42-.16-.58 0l-.88.88L20 12.75l.88-.88c.16-.16.16-.42 0-.58zM11 18.25V20h1.75l6.67-6.67-1.75-1.75zM16 4h4v4h-4z"}),"AppRegistration");ee=Z.default=Pt;var te={},Wt=P;Object.defineProperty(te,"__esModule",{value:!0});var ae=te.default=void 0,qt=Wt(F()),Ut=e,Ht=(0,qt.default)((0,Ut.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3v2zm-3-7V3.5L18.5 9H13z"}),"NoteAdd");ae=te.default=Ht;var se={},Gt=P;Object.defineProperty(se,"__esModule",{value:!0});var $e=se.default=void 0,Qt=Gt(F()),Yt=e,Xt=(0,Qt.default)((0,Yt.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");$e=se.default=Xt;var oe={},Jt=P;Object.defineProperty(oe,"__esModule",{value:!0});var Ne=oe.default=void 0,Kt=Jt(F()),Zt=e,ea=(0,Kt.default)((0,Zt.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");Ne=oe.default=ea;const ta="/assets/doc_store_details_empty-B8g8M--k.svg",o=K(Me)(({theme:a})=>({borderColor:a.palette.grey[900]+25,padding:"6px 16px",[`&.${me.head}`]:{color:a.palette.grey[900]},[`&.${me.body}`]:{fontSize:14,height:64}})),Ce=K(O)(()=>({"&:last-child td, &:last-child th":{border:0}})),Be=K(a=>e.jsx($t,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...a}))(({theme:a})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:a.spacing(1),minWidth:180,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:a.palette.text.secondary,marginRight:a.spacing(1.5)},"&:active":{backgroundColor:lt(a.palette.primary.main,a.palette.action.selectedOpacity)}}}})),Ra=()=>{var de,he,ue,pe;const a=ve(),i=ct(s=>s.customization),h=dt(),b=be();ht();const{confirm:L}=At(),p=(...s)=>b(ft(...s)),d=(...s)=>b(gt(...s)),n=Y(N.getSpecificDocumentStore),[l,T]=r.useState(null),[k,D]=r.useState(!0),[S,x]=r.useState(!1),[V,u]=r.useState(!1),[t,j]=r.useState({}),[M,I]=r.useState({}),[f,z]=r.useState(!1),[_,W]=r.useState({}),[re,B]=r.useState(!1),[Fe,ie]=r.useState({}),[ne,q]=r.useState(null),U=!!ne,{storeId:w}=ut(),Pe=s=>{h("/document-stores/"+w+"/"+s)},le=s=>{h("/document-stores/chunks/"+w+"/"+s)},We=s=>{h("/document-stores/query/"+s)},qe=s=>{z(!1),h("/document-stores/"+w+"/"+s)},Ue=s=>{h("/document-stores/vector/"+s)},ce=()=>{W({title:"Select Document Loader"}),z(!0)},He=async s=>{try{await N.deleteVectorStoreDataFromStore(s)}catch(m){console.error(m)}},Ge=async(s,m,$)=>{if(x(!0),B(!1),s==="STORE"){$&&await He(w);try{const c=await N.deleteDocumentStore(w);x(!1),c.data&&(p({message:"Store, Loader and associated document chunks deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}}),h("/document-stores/"))}catch(c){x(!1),T(c),p({message:`Failed to delete Document Store: ${typeof c.response.data=="object"?c.response.data.message:c.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}})}}else if(s==="LOADER")try{const c=await N.deleteLoaderFromStore(w,m.id);x(!1),c.data&&(p({message:"Loader and associated document chunks deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}}),H())}catch(c){T(c),x(!1),p({message:`Failed to delete Document Loader: ${typeof c.response.data=="object"?c.response.data.message:c.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}})}},Qe=(s,m,$)=>{const c={title:"Delete",description:`Delete Loader ${s.loaderName} ? This will delete all the associated document chunks.`,vectorStoreConfig:m,recordManagerConfig:$,type:"LOADER",file:s};ie(c),B(!0)},Ye=(s,m)=>{var c;const $={title:"Delete",description:`Delete Store ${(c=n.data)==null?void 0:c.name} ? This will delete all the associated loaders and document chunks.`,vectorStoreConfig:s,recordManagerConfig:m,type:"STORE"};ie($),B(!0)},Xe=async s=>{if(await L({title:"Refresh all loaders and upsert all chunks?",description:"This will re-process all loaders and upsert all chunks. This action might take some time.",confirmButtonName:"Refresh",cancelButtonName:"Cancel"})){q(null),x(!0);try{(await N.refreshLoader(s)).data&&p({message:"Document store refresh successfully!",options:{key:new Date().getTime()+Math.random(),variant:"success",action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}}),x(!1)}catch(c){x(!1),p({message:`Failed to refresh document store: ${typeof c.response.data=="object"?c.response.data.message:c.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",action:C=>e.jsx(v,{style:{color:"white"},onClick:()=>d(C),children:e.jsx(A,{})})}})}}},Je=()=>{const m={title:"Edit Document Store",type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Update",data:{name:t.name,description:t.description,id:t.id}};I(m),u(!0)},H=()=>{u(!1),n.request(w)},Ke=s=>{s.preventDefault(),s.stopPropagation(),q(s.currentTarget)},Ze=()=>{q(null)};return r.useEffect(()=>{n.request(w)},[]),r.useEffect(()=>{n.data&&j(n.data)},[n.data]),r.useEffect(()=>{n.error&&T(n.error)},[n.error]),r.useEffect(()=>{D(n.loading)},[n.loading]),e.jsxs(e.Fragment,{children:[e.jsx(pt,{children:l?e.jsx(St,{error:l}):e.jsxs(G,{flexDirection:"column",sx:{gap:3},children:[e.jsxs(wt,{isBackButton:!0,isEditButton:!0,search:!1,title:t==null?void 0:t.name,description:t==null?void 0:t.description,onBack:()=>h("/document-stores"),onEdit:()=>Je(),children:[((t==null?void 0:t.status)==="STALE"||(t==null?void 0:t.status)==="UPSERTING")&&e.jsx(Dt,{onClick:H,size:"small",color:"primary",title:"Refresh Document Store",children:e.jsx(Nt,{})}),e.jsx(ge,{variant:"contained",sx:{ml:2,minWidth:200,borderRadius:2,height:"100%",color:"white"},startIcon:e.jsx(je,{}),onClick:ce,children:"Add Document Loader"}),e.jsx(v,{id:"document-store-header-action-button","aria-controls":U?"document-store-header-menu":void 0,"aria-haspopup":"true","aria-expanded":U?"true":void 0,variant:"outlined",disableElevation:!0,color:"secondary",onClick:Ke,sx:{minWidth:150},endIcon:e.jsx(_e,{}),children:"More Actions"}),e.jsxs(Be,{id:"document-store-header-menu",MenuListProps:{"aria-labelledby":"document-store-header-menu-button"},anchorEl:ne,open:U,onClose:Ze,children:[e.jsxs(y,{disabled:(t==null?void 0:t.totalChunks)<=0||(t==null?void 0:t.status)==="UPSERTING",onClick:()=>le("all"),disableRipple:!0,children:[e.jsx(ee,{}),"View & Edit Chunks"]}),e.jsxs(y,{disabled:(t==null?void 0:t.totalChunks)<=0||(t==null?void 0:t.status)==="UPSERTING",onClick:()=>Ue(t.id),disableRipple:!0,children:[e.jsx(ae,{}),"Upsert All Chunks"]}),e.jsxs(y,{disabled:(t==null?void 0:t.totalChunks)<=0||(t==null?void 0:t.status)!=="UPSERTED",onClick:()=>We(t.id),disableRipple:!0,children:[e.jsx($e,{}),"Retrieval Query"]}),e.jsxs(y,{disabled:(t==null?void 0:t.totalChunks)<=0||(t==null?void 0:t.status)!=="UPSERTED",onClick:()=>Xe(t.id),disableRipple:!0,title:"Re-process all loaders and upsert all chunks",children:[e.jsx(Ne,{}),"Refresh"]}),e.jsx(Ie,{sx:{my:.5}}),e.jsxs(y,{onClick:()=>Ye(t.vectorStoreConfig,t.recordManagerConfig),disableRipple:!0,children:[e.jsx(Ae,{}),"Delete"]})]})]}),e.jsx(jt,{status:t==null?void 0:t.status}),((he=(de=n.data)==null?void 0:de.whereUsed)==null?void 0:he.length)>0&&e.jsxs(G,{flexDirection:"row",sx:{gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{paddingLeft:"15px",paddingRight:"15px",paddingTop:"10px",paddingBottom:"10px",fontSize:"0.9rem",width:"max-content",display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(Ct,{style:{marginRight:5},size:17}),"Chatflows Used:"]}),n.data.whereUsed.map((s,m)=>e.jsx(Q,{clickable:!0,style:{width:"max-content",borderRadius:"25px",boxShadow:i.isDarkMode?"0 2px 14px 0 rgb(255 255 255 / 10%)":"0 2px 14px 0 rgb(32 40 45 / 10%)"},label:s.name,onClick:()=>h("/canvas/"+s.id)},m))]}),!k&&t&&!((ue=t==null?void 0:t.loaders)!=null&&ue.length)?e.jsxs(G,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(X,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:ta,alt:"doc_store_details_emptySVG"})}),e.jsx("div",{children:"No Document Added Yet"}),e.jsx(ge,{variant:"contained",sx:{borderRadius:2,height:"100%",mt:2,color:"white"},startIcon:e.jsx(je,{}),onClick:ce,children:"Add Document Loader"})]}):e.jsx(Re,{sx:{border:1,borderColor:a.palette.grey[900]+25,borderRadius:2},component:Ee,children:e.jsxs(Le,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(xt,{sx:{backgroundColor:i.isDarkMode?a.palette.common.black:a.palette.grey[100],height:56},children:e.jsxs(O,{children:[e.jsx(o,{children:" "}),e.jsx(o,{children:"Loader"}),e.jsx(o,{children:"Splitter"}),e.jsx(o,{children:"Source(s)"}),e.jsx(o,{children:"Chunks"}),e.jsx(o,{children:"Chars"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(Te,{children:k?e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{children:[e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})})]}),e.jsxs(Ce,{children:[e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})}),e.jsx(o,{children:e.jsx(g,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:(t==null?void 0:t.loaders)&&(t==null?void 0:t.loaders.length)>0&&(t==null?void 0:t.loaders.map((s,m)=>e.jsx(Oe,{index:m,loader:s,theme:a,onEditClick:()=>Pe(s.id),onViewChunksClick:()=>le(s.id),onDeleteClick:()=>Qe(s,t==null?void 0:t.vectorStoreConfig,t==null?void 0:t.recordManagerConfig),onChunkUpsert:()=>h(`/document-stores/vector/${t.id}/${s.id}`)},m)))})})]})}),((pe=n.data)==null?void 0:pe.status)==="STALE"&&e.jsx("div",{style:{width:"100%",textAlign:"center",marginTop:"20px"},children:e.jsx(J,{color:"warning",style:{color:"darkred",fontWeight:500,fontStyle:"italic",fontSize:12},children:"Some files are pending processing. Please Refresh to get the latest status."})})]})}),V&&e.jsx(bt,{dialogProps:M,show:V,onCancel:()=>u(!1),onConfirm:H}),f&&e.jsx(Ve,{show:f,dialogProps:_,onCancel:()=>z(!1),onDocLoaderSelected:qe}),re&&e.jsx(ze,{show:re,dialogProps:Fe,onCancel:()=>B(!1),onDelete:Ge}),S&&e.jsx(vt,{open:S}),e.jsx(Vt,{})]})};function Oe(a){var n;const[i,h]=r.useState(null),b=!!i,L=l=>{l.preventDefault(),l.stopPropagation(),h(l.currentTarget)},p=()=>{h(null)},d=l=>l&&typeof l=="string"&&l.includes("base64")?mt(l):l&&typeof l=="string"&&l.startsWith("[")&&l.endsWith("]")?JSON.parse(l).join(", "):l;return e.jsx(e.Fragment,{children:e.jsxs(O,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0},cursor:"pointer"},children:[e.jsx(o,{onClick:a.onViewChunksClick,scope:"row",style:{width:"5%"},children:e.jsx("div",{style:{display:"flex",width:"20px",height:"20px",backgroundColor:((n=a.loader)==null?void 0:n.status)==="SYNC"?"#00e676":"#ffe57f",borderRadius:"50%"}})}),e.jsx(o,{onClick:a.onViewChunksClick,scope:"row",children:a.loader.loaderName}),e.jsx(o,{onClick:a.onViewChunksClick,children:a.loader.splitterName??"None"}),e.jsx(o,{onClick:a.onViewChunksClick,children:d(a.loader.source)}),e.jsx(o,{onClick:a.onViewChunksClick,children:a.loader.totalChunks&&e.jsx(Q,{variant:"outlined",size:"small",label:a.loader.totalChunks.toLocaleString()})}),e.jsx(o,{onClick:a.onViewChunksClick,children:a.loader.totalChars&&e.jsx(Q,{variant:"outlined",size:"small",label:a.loader.totalChars.toLocaleString()})}),e.jsx(o,{children:e.jsxs("div",{children:[e.jsx(v,{id:"document-store-action-button","aria-controls":b?"document-store-action-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":b?"true":void 0,disableElevation:!0,onClick:l=>L(l),endIcon:e.jsx(_e,{}),children:"Options"}),e.jsxs(Be,{id:"document-store-actions-customized-menu",MenuListProps:{"aria-labelledby":"document-store-actions-customized-button"},anchorEl:i,open:b,onClose:p,children:[e.jsxs(y,{onClick:a.onEditClick,disableRipple:!0,children:[e.jsx(zt,{}),"Preview & Process"]}),e.jsxs(y,{onClick:a.onViewChunksClick,disableRipple:!0,children:[e.jsx(ee,{}),"View & Edit Chunks"]}),e.jsxs(y,{onClick:a.onChunkUpsert,disableRipple:!0,children:[e.jsx(ae,{}),"Upsert Chunks"]}),e.jsx(Ie,{sx:{my:.5}}),e.jsxs(y,{onClick:a.onDeleteClick,disableRipple:!0,children:[e.jsx(Ae,{}),"Delete"]})]})]})})]},a.index)})}Oe.propTypes={loader:R.any,index:R.number,open:R.bool,theme:R.any,onViewChunksClick:R.func,onEditClick:R.func,onDeleteClick:R.func,onChunkUpsert:R.func};export{Ra as default};
