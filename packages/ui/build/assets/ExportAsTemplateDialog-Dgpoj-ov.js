import{aE as i,P as x,x as O,r as a,b as q,y as L,z as _,H as I,j as e,w as f,I as w,D as F,q as G,t as H,B as h,T as m,C as K,v as $,A as R,K as V,L as X}from"./index-ChaGAcYI.js";import{S as Y}from"./StyledButton-8-5Nm6DU.js";import{O as y}from"./OutlinedInput-CAVpSyYT.js";const J=()=>i.get("/marketplaces/chatflows"),Q=()=>i.get("/marketplaces/tools"),Z=()=>i.get("/marketplaces/templates"),P=()=>i.get("/marketplaces/custom"),ee=l=>i.post("/marketplaces/custom",l),te=l=>i.delete(`/marketplaces/custom/${l}`),se={getAllChatflowsMarketplaces:J,getAllToolsMarketplaces:Q,getAllTemplatesFromMarketplaces:Z,getAllCustomTemplates:P,saveAsCustomTemplate:ee,deleteCustomTemplate:te},ae=({show:l,dialogProps:s,onCancel:u})=>{const E=document.getElementById("portal"),n=O(),[g,p]=a.useState(""),[B,j]=a.useState(""),[A,b]=a.useState(""),[v,S]=a.useState(""),[o,C]=a.useState([]),[d,D]=a.useState(""),c=q(se.saveAsCustomTemplate),T=(...t)=>n(V(...t)),k=(...t)=>n(X(...t));L(),a.useEffect(()=>(s.chatflow&&(p(s.chatflow.name),j(s.chatflow.type==="MULTIAGENT"?"Agentflow":"Chatflow")),s.tool&&(p(s.tool.name),b(s.tool.description),j("Tool")),()=>{p(""),b(""),S(""),C([]),j(""),D("")}),[s]),a.useEffect(()=>(n(l?{type:_}:{type:I}),()=>n({type:I})),[l,n]);const N=t=>{D(t.target.value)},U=t=>{t.key==="Enter"&&d.trim()&&(t.preventDefault(),o.includes(d)||(C([...o,d]),D("")))},M=t=>{C(o.filter(r=>r!==t))},W=()=>{if(g.trim()===""){T({message:"Template Name is mandatory!",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:r=>e.jsx(f,{style:{color:"white"},onClick:()=>k(r),children:e.jsx(w,{})})}});return}const t={name:g,description:A,badge:v?v.toUpperCase():void 0,usecases:o,type:B};s.chatflow&&(t.chatflowId=s.chatflow.id),s.tool&&(t.tool={iconSrc:s.tool.iconSrc,schema:s.tool.schema,func:s.tool.func}),c.request(t)};a.useEffect(()=>{c.data&&(T({message:"Saved as template successfully!",options:{key:new Date().getTime()+Math.random(),variant:"success",persist:!0,action:t=>e.jsx(f,{style:{color:"white"},onClick:()=>k(t),children:e.jsx(w,{})})}}),u())},[c.data]),a.useEffect(()=>{c.error&&(T({message:"Failed to save as template!",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:t=>e.jsx(f,{style:{color:"white"},onClick:()=>k(t),children:e.jsx(w,{})})}}),u())},[c.error]);const z=l?e.jsxs(F,{onClose:u,open:l,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(G,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:s.title||"Export As Template"}),e.jsxs(H,{children:[e.jsx(h,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(m,{sx:{mb:1},children:["Name",e.jsx("span",{style:{color:"red"},children:"Â *"})]}),e.jsx(y,{id:"name",type:"string",fullWidth:!0,value:g,name:"name",size:"small",onChange:t=>{p(t.target.value)}})]})}),e.jsx(h,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(m,{sx:{mb:1},children:"Description"}),e.jsx(y,{id:"description",type:"string",fullWidth:!0,multiline:!0,rows:2,value:A,name:"description",size:"small",onChange:t=>{b(t.target.value)}})]})}),e.jsx(h,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(m,{sx:{mb:1},children:"Badge"}),e.jsx(y,{id:"badge",type:"string",fullWidth:!0,value:v,name:"badge",size:"small",onChange:t=>{S(t.target.value)}})]})}),e.jsx(h,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(m,{sx:{mb:1},children:"Usecases"}),o.length>0&&e.jsx("div",{style:{marginBottom:10},children:o.map((t,r)=>e.jsx(K,{label:t,onDelete:()=>M(t),style:{marginRight:5,marginBottom:5}},r))}),e.jsx(y,{fullWidth:!0,value:d,onChange:N,onKeyDown:U,variant:"outlined"}),e.jsx(m,{variant:"body2",sx:{fontStyle:"italic",mt:1},color:"text.secondary",children:"Type a usecase and press enter to add it to the list. You can add as many items as you want."})]})})]}),e.jsxs($,{children:[e.jsx(f,{onClick:u,children:s.cancelButtonName||"Cancel"}),e.jsx(Y,{disabled:s.disabled,variant:"contained",onClick:W,children:s.confirmButtonName||"Save Template"})]})]}):null;return R.createPortal(z,E)};ae.propTypes={show:x.bool,dialogProps:x.object,onCancel:x.func,onConfirm:x.func};export{ae as E,se as m};
